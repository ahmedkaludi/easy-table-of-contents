if(window.ezTocWidgetStickyInitialized)console.log("EZ TOC Widget Sticky: Already initialized");else{function ready(t){"loading"!==document.readyState?(console.log("EZ TOC Widget Sticky: DOM already ready, executing immediately"),t()):(console.log("EZ TOC Widget Sticky: Waiting for DOM to be ready..."),document.addEventListener("DOMContentLoaded",t))}window.ezTocWidgetStickyInitialized=!0,console.log("EZ TOC Widget Sticky: Starting initialization..."),ready((()=>{console.log("EZ TOC Widget Sticky: DOM ready, starting main logic...");let t,e=null,o=!1,i=!1,n=!1;const c=document.querySelector(".ez-toc-widget-sticky nav"),l=document.querySelector(".ez-toc-widget-sticky-container");if(console.log("EZ TOC Widget Sticky: Found elements:",{tocContainer:!!c,stickyContainer:!!l,tocContainerSelector:".ez-toc-widget-sticky nav",stickyContainerSelector:".ez-toc-widget-sticky-container"}),!c||!l)return console.error("EZ TOC Widget Sticky: Required elements not found"),console.log("EZ TOC Widget Sticky: Available elements with similar classes:"),void document.querySelectorAll('[class*="ez-toc"]').forEach((t=>{console.log("- Element:",t.tagName,"Classes:",t.className)}));function s(){console.log("EZ TOC Widget Sticky: Searching for article container...");const t=["article",".post-content",".entry-content",".content-area",".main-content",".post-body",".article-content",".single-post",".single-page",".post",".page",'[role="main"]',"main"];for(const e of t){console.log("EZ TOC Widget Sticky: Trying selector:",e);const t=document.querySelector(e);if(t){console.log("EZ TOC Widget Sticky: Found container with selector:",e);const o=t.getBoundingClientRect();if(console.log("EZ TOC Widget Sticky: Container dimensions:",{width:o.width,height:o.height,top:o.top,left:o.left}),o.width>0&&o.height>0)return console.log("EZ TOC Widget Sticky: Using container:",e),t;console.log("EZ TOC Widget Sticky: Container has no dimensions, skipping")}else console.log("EZ TOC Widget Sticky: No element found for selector:",e)}return console.log("EZ TOC Widget Sticky: No article container found, using body"),document.body}function a(){const t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768;return console.log("EZ TOC Widget Sticky: Device check:",{userAgent:navigator.userAgent,windowWidth:window.innerWidth,isMobile:t}),t}function r(){if(console.log("EZ TOC Widget Sticky: Initializing mobile toggle..."),i||!a())return void console.log("EZ TOC Widget Sticky: Mobile toggle already initialized or not mobile device");console.log("EZ TOC Widget Sticky: Creating mobile toggle button...");const t=document.createElement("div");t.className="ez-toc-mobile-toggle-btn",t.innerHTML='\n            <span class="ez-toc-mobile-toggle-icon">☰</span>\n            <span class="ez-toc-mobile-toggle-text">TOC</span>\n        ';const e=document.createElement("style");e.textContent="\n            .ez-toc-mobile-toggle-btn {\n                position: fixed;\n                top: 50%;\n                right: 0;\n                transform: translateY(-50%);\n                background: #007cba;\n                color: white;\n                padding: 12px 8px;\n                border-radius: 8px 0 0 8px;\n                cursor: pointer;\n                z-index: 10000;\n                box-shadow: -2px 2px 8px rgba(0,0,0,0.2);\n                transition: all 0.3s ease;\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                gap: 4px;\n                font-size: 12px;\n                font-weight: bold;\n            }\n            \n            .ez-toc-mobile-toggle-btn:hover {\n                background: #005a87;\n                transform: translateY(-50%) translateX(-2px);\n            }\n            \n            .ez-toc-mobile-toggle-icon {\n                font-size: 16px;\n                line-height: 1;\n            }\n            \n            .ez-toc-mobile-toggle-text {\n                font-size: 10px;\n                line-height: 1;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay {\n                position: fixed !important;\n                top: 0 !important;\n                left: 0 !important;\n                right: 0 !important;\n                bottom: 0 !important;\n                width: 100% !important;\n                max-width: 100% !important;\n                height: 100vh !important;\n                z-index: 10001 !important;\n                background: rgba(0,0,0,0.8) !important;\n                display: flex !important;\n                align-items: center !important;\n                justify-content: center !important;\n                padding: 20px !important;\n                box-sizing: border-box !important;\n                border: none !important;\n                border-radius: 0 !important;\n                box-shadow: none !important;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay .ez-toc-widget-sticky-content {\n                background: white;\n                border-radius: 12px;\n                max-width: 90%;\n                max-height: 80vh;\n                width: 100%;\n                overflow: hidden;\n                display: flex;\n                flex-direction: column;\n                box-shadow: 0 10px 30px rgba(0,0,0,0.3);\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay .ez-toc-widget-sticky-title {\n                padding: 15px 20px !important;\n                border-bottom: 1px solid #eee !important;\n                margin: 0 !important;\n                background: #f9f9f9 !important;\n                border-radius: 12px 12px 0 0 !important;\n                font-size: 18px !important;\n                font-weight: bold !important;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay nav {\n                padding: 20px !important;\n                max-height: 60vh !important;\n                overflow-y: auto !important;\n                flex: 1;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay .ez-toc-mobile-close-btn {\n                position: absolute;\n                top: 15px;\n                right: 15px;\n                background: none;\n                border: none;\n                font-size: 24px;\n                cursor: pointer;\n                color: #666;\n                padding: 0;\n                width: 30px;\n                height: 30px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                border-radius: 50%;\n                transition: background-color 0.2s ease;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay .ez-toc-mobile-close-btn:hover {\n                background-color: #f0f0f0;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay {\n                opacity: 0;\n                visibility: hidden;\n                transition: opacity 0.3s ease, visibility 0.3s ease;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay.show {\n                opacity: 1;\n                visibility: visible;\n            }\n            \n            @media (max-width: 768px) {\n                .ez-toc-widget-sticky-container:not(.mobile-overlay) {\n                    display: none !important;\n                }\n            }\n        ",document.head.appendChild(e),document.body.appendChild(t),console.log("EZ TOC Widget Sticky: Mobile toggle button added to DOM");const o=l.innerHTML;l.innerHTML=`\n            <div class="ez-toc-widget-sticky-content">\n                <button class="ez-toc-mobile-close-btn" aria-label="Close Table of Contents">×</button>\n                ${o}\n            </div>\n        `,console.log("EZ TOC Widget Sticky: Mobile overlay content wrapped"),t.addEventListener("click",(function(){console.log("EZ TOC Widget Sticky: Mobile toggle button clicked"),l.classList.add("mobile-overlay","show"),document.body.style.overflow="hidden"}));const n=l.querySelector(".ez-toc-mobile-close-btn");function c(){console.log("EZ TOC Widget Sticky: Closing mobile overlay"),l.classList.remove("show"),setTimeout((()=>{l.classList.remove("mobile-overlay"),document.body.style.overflow=""}),200)}n&&n.addEventListener("click",(function(){console.log("EZ TOC Widget Sticky: Mobile close button clicked"),c()})),l.addEventListener("click",(function(t){t.target===l&&(console.log("EZ TOC Widget Sticky: Clicked outside mobile overlay content"),c())})),document.addEventListener("keydown",(function(t){"Escape"===t.key&&l.classList.contains("mobile-overlay")&&(console.log("EZ TOC Widget Sticky: Escape key pressed, closing mobile overlay"),c())})),l.addEventListener("click",(function(t){t.target.closest("a")&&a()&&(console.log("EZ TOC Widget Sticky: Link clicked in mobile overlay, closing"),l.classList.remove("show"),l.classList.remove("mobile-overlay"),document.body.style.overflow="")})),i=!0,console.log("EZ TOC Widget Sticky: Mobile toggle initialized successfully")}function d(){if(console.log("EZ TOC Widget Sticky: Initializing sticky functionality..."),o||!l)return void console.log("EZ TOC Widget Sticky: Sticky already initialized or container not found");if(a())return void console.log("EZ TOC Widget Sticky: Skipping sticky initialization on mobile device");const t=s();if(console.log("EZ TOC Widget Sticky: Article container found:",{tagName:t.tagName,className:t.className,id:t.id}),console.log("EZ TOC Widget Sticky: Checking for jQuery and sticky-kit..."),console.log("EZ TOC Widget Sticky: jQuery available:","undefined"!=typeof jQuery),console.log("EZ TOC Widget Sticky: sticky-kit available:","undefined"!=typeof jQuery&&jQuery.fn.stick_in_parent),"undefined"!=typeof jQuery&&jQuery.fn.stick_in_parent){const i=jQuery;try{const n="undefined"!=typeof ezTocWidgetSticky&&ezTocWidgetSticky.fixed_top_position?parseInt(ezTocWidgetSticky.fixed_top_position):30;console.log("EZ TOC Widget Sticky: Using offset top:",n),console.log("EZ TOC Widget Sticky: ezTocWidgetSticky object:",ezTocWidgetSticky),console.log("EZ TOC Widget Sticky: Calling stick_in_parent with body parent..."),i(l).stick_in_parent({inner_scrolling:!1,offset_top:n,sticky_class:"is_stuck",parent:"body"}),o=!0,console.log("EZ TOC Widget Sticky: Sticky initialized successfully with body parent");let c=!1;l.offsetTop,l.style.position;function e(){if(!c)return;const e=window.pageYOffset||document.documentElement.scrollTop,o=t.offsetTop+t.offsetHeight,i=l.offsetHeight;l.offsetTop;if(e+i+n>o){const t=o-i-n;l.style.top=Math.max(n,t)+"px",console.log("EZ TOC Widget Sticky: Respecting article bottom boundary")}else l.style.top=n+"px"}i(window).on("resize",(function(){console.log("EZ TOC Widget Sticky: Window resized"),a()?i(l).hasClass("is_stuck")&&(console.log("EZ TOC Widget Sticky: Recalculating sticky on mobile resize"),i(l).trigger("sticky_kit:recalc")):i(l).hasClass("is_stuck")&&(console.log("EZ TOC Widget Sticky: Recalculating sticky on resize"),i(l).trigger("sticky_kit:recalc"),e())})),i(window).on("scroll",(function(){i(l).hasClass("is_stuck")&&e()}))}catch(r){console.error("EZ TOC Widget Sticky: Error initializing sticky functionality:",r)}}else console.warn("EZ TOC Widget Sticky: jQuery or sticky-kit not available")}console.log("EZ TOC Widget Sticky: Determining device type and initializing..."),a()?(console.log("EZ TOC Widget Sticky: Mobile device detected, initializing mobile toggle"),r()):(console.log("EZ TOC Widget Sticky: Desktop device detected, initializing sticky"),d());let g=a();function y(t,e){const o=e.getBoundingClientRect(),i=t.getBoundingClientRect();return i.top>=o.top&&i.bottom<=o.bottom}console.log("EZ TOC Widget Sticky: Initial device type:",g?"mobile":"desktop"),window.addEventListener("resize",(function(){const t=a();if(t!==g)if(console.log("EZ TOC Widget Sticky: Device type changed from",g?"mobile":"desktop","to",t?"mobile":"desktop"),g=t,t){if(console.log("EZ TOC Widget Sticky: Switching to mobile mode"),o){if("undefined"!=typeof jQuery&&jQuery.fn.stick_in_parent){const t=jQuery;console.log("EZ TOC Widget Sticky: Detaching sticky functionality"),t(l).trigger("sticky_kit:detach")}o=!1}r()}else{if(console.log("EZ TOC Widget Sticky: Switching to desktop mode"),i){const t=document.querySelector(".ez-toc-mobile-toggle-btn");t&&(console.log("EZ TOC Widget Sticky: Removing mobile toggle button"),t.remove()),i=!1}d()}})),o||a()||(console.log("EZ TOC Widget Sticky: Sticky not initialized, trying again in 1 second..."),setTimeout((()=>{console.log("EZ TOC Widget Sticky: Retrying sticky initialization..."),d()}),1e3)),setTimeout((()=>{o||a()||(console.log("EZ TOC Widget Sticky: Sticky still not initialized, trying again in 3 seconds..."),d())}),3e3),window.addEventListener("load",(()=>{console.log("EZ TOC Widget Sticky: Page fully loaded, final initialization attempt..."),o||a()||(console.log("EZ TOC Widget Sticky: Final sticky initialization attempt"),d()),!i&&a()&&(console.log("EZ TOC Widget Sticky: Final mobile toggle initialization attempt"),r())})),setTimeout((()=>{o||a()||(console.log("EZ TOC Widget Sticky: Sticky-kit failed, trying fallback sticky..."),function(){if(console.log("EZ TOC Widget Sticky: Initializing fallback sticky functionality..."),!o&&l)if(a())console.log("EZ TOC Widget Sticky: Skipping fallback sticky initialization on mobile device");else try{const e=s(),i="undefined"!=typeof ezTocWidgetSticky&&ezTocWidgetSticky.fixed_top_position?parseInt(ezTocWidgetSticky.fixed_top_position):30;console.log("EZ TOC Widget Sticky: Fallback sticky settings:",{offsetTop:i,articleContainer:e.tagName,stickyContainer:l.tagName});let n=!1;const c=l.offsetTop,r=l.style.position,d=e.getBoundingClientRect();function t(){if(a())return;const t=window.pageYOffset||document.documentElement.scrollTop,o=e.offsetTop,s=o+e.offsetHeight,d=l.offsetHeight;console.log("EZ TOC Widget Sticky: Fallback scroll handling:",{scrollTop:t,containerTop:o,containerBottom:s,stickyHeight:d,isSticky:n}),t>c-i&&!n?(console.log("EZ TOC Widget Sticky: Making element sticky"),l.style.position="fixed",l.style.top=i+"px",l.style.zIndex="9999",l.classList.add("is_stuck"),n=!0):t+d+i>s&&n?(console.log("EZ TOC Widget Sticky: Reaching container bottom, adjusting position"),l.style.position="absolute",l.style.top=s-d-i+"px",l.style.zIndex="9999",l.classList.add("is_stuck")):t<=c-i&&n&&(console.log("EZ TOC Widget Sticky: Returning to normal position"),l.style.position=r,l.style.top="",l.style.zIndex="",l.classList.remove("is_stuck"),n=!1)}console.log("EZ TOC Widget Sticky: Fallback sticky initial positions:",{originalTop:c,originalPosition:r,containerRect:d}),window.addEventListener("scroll",t),window.addEventListener("resize",t),o=!0,console.log("EZ TOC Widget Sticky: Fallback sticky initialized successfully with article container")}catch(g){console.error("EZ TOC Widget Sticky: Error initializing fallback sticky:",g)}else console.log("EZ TOC Widget Sticky: Fallback sticky already initialized or container not found")}())}),5e3);let u=0,f="down";function m(){t=new IntersectionObserver((t=>{if(n)return;!function(){const t=window.pageYOffset||document.documentElement.scrollTop;f=t>u?"down":"up",u=t}();const o=function(){const t=document.querySelectorAll(".ez-toc-widget-sticky nav li a"),e=new Map,o=[];t.forEach((t=>{const i=t.getAttribute("href");if(i&&i.startsWith("#")){const n=i.substring(1),c=document.getElementById(n);if(c){const i=c.getBoundingClientRect(),l=i.top+window.pageYOffset,s=i.bottom+window.pageYOffset,a=l+i.height/2;e.set(n,t),o.push({id:n,link:t,top:l,bottom:s,center:a,element:c})}}})),o.sort(((t,e)=>t.top-e.top));const i=window.pageYOffset+50;let n=null;if("down"===f){const t=document.querySelector(".ez-toc-widget-sticky nav li.active");if(t){const e=t.querySelector("a");if(e){const t=e.getAttribute("href");if(t&&t.startsWith("#")){const e=t.substring(1),c=o.find((t=>t.id===e));if(c)if(i>=c.bottom+100){const t=o.findIndex((t=>t.id===e));n=t<o.length-1?o[t+1]:c}else n=c}}}}if(!n){for(let t=0;t<o.length;t++){const e=o[t];if(e.top>=i){n=e;break}}if(!n&&o.length>0&&(n=o[o.length-1]),"up"===f&&n){const t=o.findIndex((t=>t.id===n.id));if(t>0){const e=o[t],c=o[t-1];e.top>i&&(n=c)}}}return n}();if(!o)return;const i=document.querySelectorAll(".ez-toc-widget-sticky nav li a"),l=new Map;i.forEach((t=>{const e=t.getAttribute("href");if(e&&e.startsWith("#")){const o=e.substring(1);l.set(o,t)}}));let s=o.id,a=l.get(o.id);if(a){const t=a.closest("li");if(t){const e=t.querySelectorAll("ul li a"),i=[];if(e.forEach((t=>{const e=t.getAttribute("href");if(e&&e.startsWith("#")){const t=e.substring(1),o=document.getElementById(t);if(o){const e=o.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0&&i.push(t)}}})),i.length>0){let t=null;const e=window.pageYOffset+50;for(let o=0;o<i.length;o++){const n=i[o],c=document.getElementById(n);if(c){if(c.getBoundingClientRect().top+window.pageYOffset>=e){t=n;break}}}t&&o.top<e&&(s=t,a=l.get(t))}}}const r=document.querySelectorAll(".ez-toc-widget-sticky nav li.active");if(a){r.length>0&&r.forEach((t=>{t.classList.remove("active")}));const t=a.closest("li");t&&(t.classList.add("active"),e=t,y(t,c)||t.scrollIntoView({behavior:"smooth",block:"center"}))}}),{threshold:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],rootMargin:"0px 0px -80% 0px"})}m();const k=[".ez-toc-section","[id] h1, [id] h2, [id] h3, [id] h4, [id] h5, [id] h6","h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]",".ez-toc-heading","[id]"];let p=!1;for(const e of k){const o=document.querySelectorAll(e);if(o.length>0){o.forEach((e=>{e.getAttribute("id")&&t.observe(e)})),p=!0;break}}p||console.warn("EZ TOC Widget Sticky: No heading sections found to observe"),c.addEventListener("click",(o=>{const i=o.target.closest("a");if(i){const o=i.getAttribute("href");if(o&&o.startsWith("#")){!function(t){console.log("EZ TOC Widget Sticky: Highlighting heading:",t);const o=document.querySelectorAll(".ez-toc-widget-sticky nav li a"),i=document.querySelectorAll(".ez-toc-widget-sticky nav li.active");i.length>0&&i.forEach((t=>{t.classList.remove("active")}));let n=null;if(o.forEach((e=>{const o=e.getAttribute("href");o&&o.startsWith("#")&&o.substring(1)===t&&(n=e)})),n){const t=n.closest("li");t&&(t.classList.add("active"),e=t,y(t,c)||t.scrollIntoView({behavior:"smooth",block:"center"}))}}(o.substring(1))}a()&&l.classList.contains("mobile-overlay")&&(l.classList.remove("show"),l.classList.remove("mobile-overlay"),document.body.style.overflow=""),n=!0,t.disconnect(),setTimeout((()=>{n=!1,m();const e=[".ez-toc-section","[id] h1, [id] h2, [id] h3, [id] h4, [id] h5, [id] h6","h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]",".ez-toc-heading","[id]"];for(const o of e){const e=document.querySelectorAll(o);if(e.length>0){e.forEach((e=>{e.getAttribute("id")&&t.observe(e)}));break}}}),3e3)}})),document.addEventListener("click",(t=>{const e=t.target.closest("a");if(e&&a()&&l.classList.contains("mobile-overlay")){e.closest(".ez-toc-widget-sticky-container")&&(l.classList.remove("show"),l.classList.remove("mobile-overlay"),document.body.style.overflow="")}})),l.addEventListener("click",(t=>{t.target.closest("a")&&a()&&l.classList.contains("mobile-overlay")&&(l.classList.remove("show"),l.classList.remove("mobile-overlay"),document.body.style.overflow="")}))}))}document.addEventListener("DOMContentLoaded",(function(){const t=document.querySelector(".ez-toc-widget-sticky-container");let e=document.querySelector("article");function o(){if(!t||!e)return;const o=t.getBoundingClientRect(),i=e.getBoundingClientRect();o.top>=i.top&&o.bottom<=i.bottom?(t.style.opacity="1",t.style.pointerEvents="auto"):(t.style.opacity="0",t.style.pointerEvents="none")}document.querySelector("article")?e=document.querySelector("article"):document.querySelector(".post-content")?e=document.querySelector(".post-content"):document.querySelector(".entry-content")?e=document.querySelector(".entry-content"):document.querySelector(".single-post-content")?e=document.querySelector(".single-post-content"):document.querySelector(".content-area")&&(e=document.querySelector(".content-area")),o(),document.addEventListener("scroll",o),window.addEventListener("resize",o)}));