if(window.ezTocWidgetStickyInitialized)console.log("EZ TOC Widget Sticky: Already initialized");else{function ready(t){"loading"!==document.readyState?t():document.addEventListener("DOMContentLoaded",t)}window.ezTocWidgetStickyInitialized=!0,ready((()=>{let t,e=null,n=!1,i=!1,o=!1;const c=document.querySelector(".ez-toc-widget-sticky nav"),s=document.querySelector(".ez-toc-widget-sticky-container");if(!c||!s)return void console.warn("EZ TOC Widget Sticky: Required elements not found");function r(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768}function l(){if(i||!r())return;const t=document.createElement("div");t.className="ez-toc-mobile-toggle-btn",t.innerHTML='\n            <span class="ez-toc-mobile-toggle-icon">☰</span>\n            <span class="ez-toc-mobile-toggle-text">TOC</span>\n        ';const e=document.createElement("style");e.textContent="\n            .ez-toc-mobile-toggle-btn {\n                position: fixed;\n                top: 50%;\n                right: 0;\n                transform: translateY(-50%);\n                background: #007cba;\n                color: white;\n                padding: 12px 8px;\n                border-radius: 8px 0 0 8px;\n                cursor: pointer;\n                z-index: 10000;\n                box-shadow: -2px 2px 8px rgba(0,0,0,0.2);\n                transition: all 0.3s ease;\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                gap: 4px;\n                font-size: 12px;\n                font-weight: bold;\n            }\n            \n            .ez-toc-mobile-toggle-btn:hover {\n                background: #005a87;\n                transform: translateY(-50%) translateX(-2px);\n            }\n            \n            .ez-toc-mobile-toggle-icon {\n                font-size: 16px;\n                line-height: 1;\n            }\n            \n            .ez-toc-mobile-toggle-text {\n                font-size: 10px;\n                line-height: 1;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay {\n                position: fixed !important;\n                top: 0 !important;\n                left: 0 !important;\n                right: 0 !important;\n                bottom: 0 !important;\n                width: 100% !important;\n                max-width: 100% !important;\n                height: 100vh !important;\n                z-index: 10001 !important;\n                background: rgba(0,0,0,0.8) !important;\n                display: flex !important;\n                align-items: center !important;\n                justify-content: center !important;\n                padding: 20px !important;\n                box-sizing: border-box !important;\n                border: none !important;\n                border-radius: 0 !important;\n                box-shadow: none !important;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay .ez-toc-widget-sticky-content {\n                background: white;\n                border-radius: 12px;\n                max-width: 90%;\n                max-height: 80vh;\n                width: 100%;\n                overflow: hidden;\n                display: flex;\n                flex-direction: column;\n                box-shadow: 0 10px 30px rgba(0,0,0,0.3);\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay .ez-toc-widget-sticky-title {\n                padding: 15px 20px !important;\n                border-bottom: 1px solid #eee !important;\n                margin: 0 !important;\n                background: #f9f9f9 !important;\n                border-radius: 12px 12px 0 0 !important;\n                font-size: 18px !important;\n                font-weight: bold !important;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay nav {\n                padding: 20px !important;\n                max-height: 60vh !important;\n                overflow-y: auto !important;\n                flex: 1;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay .ez-toc-mobile-close-btn {\n                position: absolute;\n                top: 15px;\n                right: 15px;\n                background: none;\n                border: none;\n                font-size: 24px;\n                cursor: pointer;\n                color: #666;\n                padding: 0;\n                width: 30px;\n                height: 30px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                border-radius: 50%;\n                transition: background-color 0.2s ease;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay .ez-toc-mobile-close-btn:hover {\n                background-color: #f0f0f0;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay {\n                opacity: 0;\n                visibility: hidden;\n                transition: opacity 0.3s ease, visibility 0.3s ease;\n            }\n            \n            .ez-toc-widget-sticky-container.mobile-overlay.show {\n                opacity: 1;\n                visibility: visible;\n            }\n            \n            @media (max-width: 768px) {\n                .ez-toc-widget-sticky-container:not(.mobile-overlay) {\n                    display: none !important;\n                }\n            }\n        ",document.head.appendChild(e),document.body.appendChild(t);const n=s.innerHTML;s.innerHTML=`\n            <div class="ez-toc-widget-sticky-content">\n                <button class="ez-toc-mobile-close-btn" aria-label="Close Table of Contents">×</button>\n                ${n}\n            </div>\n        `,t.addEventListener("click",(function(){s.classList.add("mobile-overlay","show"),document.body.style.overflow="hidden"}));const o=s.querySelector(".ez-toc-mobile-close-btn");function c(){s.classList.remove("show"),setTimeout((()=>{s.classList.remove("mobile-overlay"),document.body.style.overflow=""}),200)}o&&o.addEventListener("click",(function(){c()})),s.addEventListener("click",(function(t){t.target===s&&c()})),document.addEventListener("keydown",(function(t){"Escape"===t.key&&s.classList.contains("mobile-overlay")&&c()})),s.addEventListener("click",(function(t){t.target.closest("a")&&r()&&(s.classList.remove("show"),s.classList.remove("mobile-overlay"),document.body.style.overflow="")})),i=!0,console.log("EZ TOC Widget Sticky: Mobile toggle initialized")}function a(){if(!n&&s)if(r())console.log("EZ TOC Widget Sticky: Skipping sticky initialization on mobile device");else if("undefined"!=typeof jQuery&&jQuery.fn.stick_in_parent){const t=jQuery;try{const e="undefined"!=typeof ezTocWidgetSticky&&ezTocWidgetSticky.fixed_top_position?parseInt(ezTocWidgetSticky.fixed_top_position):30;t(s).stick_in_parent({inner_scrolling:!1,offset_top:e,sticky_class:"is_stuck",parent:"body"}),n=!0,console.log("EZ TOC Widget Sticky: Initialized successfully"),t(window).on("resize",(function(){r(),t(s).hasClass("is_stuck")&&t(s).trigger("sticky_kit:recalc")}))}catch(t){console.error("EZ TOC Widget Sticky: Error initializing sticky functionality:",t)}}else console.warn("EZ TOC Widget Sticky: jQuery or sticky-kit not available")}r()?l():a();let d=r();function g(t,e){const n=e.getBoundingClientRect(),i=t.getBoundingClientRect();return i.top>=n.top&&i.bottom<=n.bottom}window.addEventListener("resize",(function(){const t=r();if(t!==d)if(d=t,t){if(n){if("undefined"!=typeof jQuery&&jQuery.fn.stick_in_parent){jQuery(s).trigger("sticky_kit:detach")}n=!1}l()}else{if(i){const t=document.querySelector(".ez-toc-mobile-toggle-btn");t&&t.remove(),i=!1}a()}})),n||r()||setTimeout((()=>{a()}),1e3),setTimeout((()=>{n||r()||a()}),3e3),window.addEventListener("load",(()=>{n||r()||a(),!i&&r()&&l()})),setTimeout((()=>{n||r()||function(){if(!n&&s)if(r())console.log("EZ TOC Widget Sticky: Skipping fallback sticky initialization on mobile device");else try{const e="undefined"!=typeof ezTocWidgetSticky&&ezTocWidgetSticky.fixed_top_position?parseInt(ezTocWidgetSticky.fixed_top_position):30;let i=!1;const o=s.offsetTop,c=s.style.position;function t(){if(r())return;const t=window.pageYOffset||document.documentElement.scrollTop;t>o-e&&!i?(s.style.position="fixed",s.style.top=e+"px",s.style.zIndex="9999",s.classList.add("is_stuck"),i=!0):t<=o-e&&i&&(s.style.position=c,s.style.top="",s.style.zIndex="",s.classList.remove("is_stuck"),i=!1)}window.addEventListener("scroll",t),window.addEventListener("resize",t),n=!0,console.log("EZ TOC Widget Sticky: Fallback sticky initialized")}catch(l){console.error("EZ TOC Widget Sticky: Error initializing fallback sticky:",l)}}()}),5e3);let f=0,u="down";function p(){t=new IntersectionObserver((t=>{if(o)return;!function(){const t=window.pageYOffset||document.documentElement.scrollTop;u=t>f?"down":"up",f=t}();const n=function(){const t=document.querySelectorAll(".ez-toc-widget-sticky nav li a"),e=new Map,n=[];t.forEach((t=>{const i=t.getAttribute("href");if(i&&i.startsWith("#")){const o=i.substring(1),c=document.getElementById(o);if(c){const i=c.getBoundingClientRect(),s=i.top+window.pageYOffset,r=i.bottom+window.pageYOffset,l=s+i.height/2;e.set(o,t),n.push({id:o,link:t,top:s,bottom:r,center:l,element:c})}}})),n.sort(((t,e)=>t.top-e.top));const i=window.pageYOffset+50;let o=null;if("down"===u){const t=document.querySelector(".ez-toc-widget-sticky nav li.active");if(t){const e=t.querySelector("a");if(e){const t=e.getAttribute("href");if(t&&t.startsWith("#")){const e=t.substring(1),c=n.find((t=>t.id===e));if(c)if(i>=c.bottom+100){const t=n.findIndex((t=>t.id===e));o=t<n.length-1?n[t+1]:c}else o=c}}}}if(!o){for(let t=0;t<n.length;t++){const e=n[t];if(e.top>=i){o=e;break}}if(!o&&n.length>0&&(o=n[n.length-1]),"up"===u&&o){const t=n.findIndex((t=>t.id===o.id));if(t>0){const e=n[t],c=n[t-1];e.top>i&&(o=c)}}}return o}();if(!n)return;const i=document.querySelectorAll(".ez-toc-widget-sticky nav li a"),s=new Map;i.forEach((t=>{const e=t.getAttribute("href");if(e&&e.startsWith("#")){const n=e.substring(1);s.set(n,t)}}));let r=n.id,l=s.get(n.id);if(l){const t=l.closest("li");if(t){const e=t.querySelectorAll("ul li a"),i=[];if(e.forEach((t=>{const e=t.getAttribute("href");if(e&&e.startsWith("#")){const t=e.substring(1),n=document.getElementById(t);if(n){const e=n.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0&&i.push(t)}}})),i.length>0){let t=null;const e=window.pageYOffset+50;for(let n=0;n<i.length;n++){const o=i[n],c=document.getElementById(o);if(c){if(c.getBoundingClientRect().top+window.pageYOffset>=e){t=o;break}}}t&&n.top<e&&(r=t,l=s.get(t))}}}const a=document.querySelectorAll(".ez-toc-widget-sticky nav li.active");if(l){a.length>0&&a.forEach((t=>{t.classList.remove("active")}));const t=l.closest("li");t&&(t.classList.add("active"),e=t,g(t,c)||t.scrollIntoView({behavior:"smooth",block:"center"}))}}),{threshold:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],rootMargin:"0px 0px -80% 0px"})}p();const m=[".ez-toc-section","[id] h1, [id] h2, [id] h3, [id] h4, [id] h5, [id] h6","h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]",".ez-toc-heading","[id]"];let y=!1;for(const e of m){const n=document.querySelectorAll(e);if(n.length>0){n.forEach((e=>{e.getAttribute("id")&&t.observe(e)})),y=!0;break}}c.addEventListener("click",(n=>{const i=n.target.closest("a");if(i){const n=i.getAttribute("href");if(n&&n.startsWith("#")){!function(t){const n=document.querySelectorAll(".ez-toc-widget-sticky nav li a"),i=document.querySelectorAll(".ez-toc-widget-sticky nav li.active");i.length>0&&i.forEach((t=>{t.classList.remove("active")}));let o=null;if(n.forEach((e=>{const n=e.getAttribute("href");n&&n.startsWith("#")&&n.substring(1)===t&&(o=e)})),o){const t=o.closest("li");t&&(t.classList.add("active"),e=t,g(t,c)||t.scrollIntoView({behavior:"smooth",block:"center"}))}}(n.substring(1))}r()&&s.classList.contains("mobile-overlay")&&(s.classList.remove("show"),s.classList.remove("mobile-overlay"),document.body.style.overflow=""),o=!0,t.disconnect(),setTimeout((()=>{o=!1,p();const e=[".ez-toc-section","[id] h1, [id] h2, [id] h3, [id] h4, [id] h5, [id] h6","h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]",".ez-toc-heading","[id]"];for(const n of e){const e=document.querySelectorAll(n);if(e.length>0){e.forEach((e=>{e.getAttribute("id")&&t.observe(e)}));break}}}),3e3)}})),document.addEventListener("click",(t=>{const e=t.target.closest("a");if(e&&r()&&s.classList.contains("mobile-overlay")){e.closest(".ez-toc-widget-sticky-container")&&(s.classList.remove("show"),s.classList.remove("mobile-overlay"),document.body.style.overflow="")}})),s.addEventListener("click",(t=>{t.target.closest("a")&&r()&&s.classList.contains("mobile-overlay")&&(s.classList.remove("show"),s.classList.remove("mobile-overlay"),document.body.style.overflow="")}))}))}